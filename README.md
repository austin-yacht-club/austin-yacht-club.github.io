# W017 Timeseries Image Automation

This repository contains automation scripts for downloading and processing images from the W017 sensor in the Sage Continuum project, and automatically publishes them to a GitHub Pages dashboard.

## üåê Live Dashboard

The latest W017 sensor image is automatically published to GitHub Pages:
**[View Live Dashboard](https://yourusername.github.io/w017-timeseries/)**

The dashboard features:
- üì∏ Real-time display of the latest sensor image
- üìä Statistics and monitoring information
- üì± Mobile-responsive design
- üîÑ Auto-refresh every 5 minutes
- üñºÔ∏è Fullscreen image viewing
- üíæ Download functionality
- ‚å®Ô∏è Keyboard shortcuts (R: refresh, F: fullscreen, D: download)

## GitHub Action: Update Latest Image

The repository includes a GitHub Action that automatically downloads the most recent W017 image, saves it as `w017.png`, and deploys it to GitHub Pages.

### Features

- **Scheduled Updates**: Runs every hour to check for new images
- **Manual Trigger**: Can be triggered manually via GitHub Actions UI
- **Smart Updates**: Only commits changes if the image has actually changed
- **Multiple Auth Methods**: Tries various authentication methods to ensure reliable downloads
- **Error Handling**: Robust error handling with detailed logging
- **GitHub Pages**: Automatically deploys updates to the live dashboard
- **Mobile Responsive**: Dashboard works perfectly on mobile devices

### Setup

To use this GitHub Action and enable GitHub Pages, you need to:

1. **Add Repository Secrets**:
   - Go to your repository Settings ‚Üí Secrets and variables ‚Üí Actions
   - Add the following secrets:
     - `SAGE_USERNAME`: Your Sage Continuum username (e.g., "ericvh")
     - `SAGE_ACCESS_TOKEN`: Your Sage Continuum access token (e.g., "Y0S1OVQG9MKD5VZNS9B5")

2. **Enable GitHub Pages**:
   - Go to your repository Settings ‚Üí Pages
   - Set Source to "GitHub Actions"
   - The site will be available at `https://yourusername.github.io/repository-name/`

3. **Optional**: Run the placeholder script to create an initial image:
   ```bash
   chmod +x create-placeholder.sh
   ./create-placeholder.sh
   ```

### How it Works

1. **API Query**: Uses the same API endpoint and payload as your `grab.sh` script
2. **Downloads Image**: Uses the same authentication methods as your Python script
3. **Saves as w017.png**: Stores the latest image with a consistent filename
4. **Commits Changes**: Only commits if the image has actually changed
5. **Deploys to GitHub Pages**: Automatically updates the live dashboard
6. **Provides Logs**: Detailed logging for troubleshooting

### Manual Trigger

You can manually trigger the action by:

1. Going to the "Actions" tab in your GitHub repository
2. Selecting "Update Latest W017 Image" workflow
3. Clicking "Run workflow"

### Monitoring

The action provides detailed logs and a summary showing:
- Whether the image was updated
- File size of the downloaded image
- Timestamp of the update
- Any errors encountered

### Files in this Repository

**Dashboard Files:**
- `index.html`: Main dashboard page
- `style.css`: Dashboard styling and responsive design
- `script.js`: Interactive functionality and auto-refresh
- `404.html`: Custom 404 error page

**Automation Scripts:**
- `grab.py`: Python script for grabbing a single image
- `grab.sh`: Shell script for grabbing a single image
- `create-placeholder.sh`: Script for creating placeholder images

**Configuration:**
- `.gitignore`: Git ignore file to prevent unnecessary files from being committed
- `README.md`: This documentation file

**GitHub Actions:**
- `.github/workflows/update-latest-image.yml`: Main workflow for updating images
- `.github/workflows/pages.yml`: GitHub Pages deployment workflow
- `.github/workflows/validate.yml`: Code validation workflow

**Generated Files:**
- `w017.png`: Latest sensor image (auto-generated by GitHub Action)

### API Reference

The automation uses the Sage Continuum Data API:
- **Endpoint**: `https://data.sagecontinuum.org/api/v1/query`
- **Filter**: VSN "W017", task "imagesampler-bottom"
- **Time Range**: Last 80 hours

### Troubleshooting

If the action fails:

1. **Check Secrets**: Ensure `SAGE_USERNAME` and `SAGE_ACCESS_TOKEN` are correctly set
2. **API Status**: Verify the Sage Continuum API is accessible
3. **Permissions**: Ensure the repository has write permissions for the action
4. **Rate Limits**: Check if there are any API rate limits being hit

View the action logs for detailed error information and which authentication method succeeded or failed.
